<%- include('../partials/adminHeader')%>


    <!--start page wrapper -->
    <div class="page-wrapper">
        <div class="page-content">
            <!--breadcrumb-->
            <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
                <div class="breadcrumb-title pe-3">Category Forms</div>
                <div class="ps-3">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb mb-0 p-0">
                            <li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i></a>
                            </li>
                            <li class="breadcrumb-item active" aria-current="page">Form Layouts</li>
                        </ol>
                    </nav>
                </div>
                <div class="ms-auto">
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary">Settings</button>
                        <button type="button"
                            class="btn btn-primary split-bg-primary dropdown-toggle dropdown-toggle-split"
                            data-bs-toggle="dropdown"> <span class="visually-hidden">Toggle Dropdown</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-end"> <a class="dropdown-item"
                                href="javascript:;">Action</a>
                            <a class="dropdown-item" href="javascript:;">Another action</a>
                            <a class="dropdown-item" href="javascript:;">Something else here</a>
                            <div class="dropdown-divider"></div> <a class="dropdown-item" href="javascript:;">Separated
                                link</a>
                        </div>
                    </div>
                </div>
            </div>
            <!--end breadcrumb-->
            <div class="row">
                <div class="col-xl-7 mx-auto">
                    <h6 class="mb-0 text-uppercase">Basic Form</h6>
                    <hr />
                    <div class="card border-top border-0 border-4 border-primary">
                        <div class="card-body p-5">
                            <div class="card-title d-flex align-items-center">
                                <div><i class="bx bxs-user me-1 font-22 text-primary"></i>
                                </div>
                                <h5 class="mb-0 text-primary">Update Sub Category</h5>
                            </div>
                            <hr>
                            <form id="form" class="row g-3">

                                <div class="col-md-6">
                                    <label for="inputFirstName" class="form-label">Name</label>
                                    <input type="text" name="name" class="form-control" value="<%=singleSubCat.name%>">
                                </div>
                                <div class="col-md-6">
                                    <label for="inputFirstName" class="form-label">Urdu Name</label>
                                    <input type="text" name="name_ur" class="form-control"
                                        value="<%=singleSubCat.name_ur%>">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Image Url</label>
                                    <input type="file" name="imageUrl"   id="imageUrl" class="form-control">
                                    <a class="btn btn-primary" onclick="uploadImage()">Upload Image</a>
                                    <input type="hidden" id="hidden" value="<%=singleSubCat.imageUrl%>" name="hidden">
                                </div>
                                <div class="col-md-4">
                                    <label for="inputState" class="form-label">Select Category</label>
                                    <select id="inputState" name="catId" class="form-select">
                                        <option selected>Choose...</option>
                                        <%allCat.forEach((e)=>{%>
                                            <option value="<%=e.id%>">
                                                <%=e.name%>
                                            </option>
                                            <%})%>

                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="inputPassword" class="form-label">Select Status</label>
                                    <select class="form-select" name="status" id="">
                                        <option selected>Choose...</option>
                                        <option value="0">False</option>
                                        <option value="1">True</option>

                                    </select>

                                </div>

                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary px-5">Update Sub Category</button>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>
            <!--end row-->

            <!--end row-->
        </div>
    </div>
    <!--end page wrapper -->
    <!--start overlay-->
    <div class="overlay toggle-icon"></div>
    <!--end overlay-->
    <!--Start Back To Top Button--><a href="javaScript:;" class="back-to-top"><i class='bx bxs-up-arrow-alt'></i></a>
    <!--End Back To Top Button-->
    <footer class="page-footer">
        <p class="mb-0">Copyright Â© 2021. All right reserved.</p>
    </footer>
    </div>
    <!--end wrapper-->
    <!--start switcher-->
    <div class="switcher-wrapper">
        <div class="switcher-btn"> <i class='bx bx-cog bx-spin'></i>
        </div>
        <div class="switcher-body">
            <div class="d-flex align-items-center">
                <h5 class="mb-0 text-uppercase">Theme Customizer</h5>
                <button type="button" class="btn-close ms-auto close-switcher" aria-label="Close"></button>
            </div>
            <hr />
            <h6 class="mb-0">Theme Styles</h6>
            <hr />
            <div class="d-flex align-items-center justify-content-between">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="lightmode" checked>
                    <label class="form-check-label" for="lightmode">Light</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="darkmode">
                    <label class="form-check-label" for="darkmode">Dark</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="semidark">
                    <label class="form-check-label" for="semidark">Semi Dark</label>
                </div>
            </div>
            <hr />
            <div class="form-check">
                <input class="form-check-input" type="radio" id="minimaltheme" name="flexRadioDefault">
                <label class="form-check-label" for="minimaltheme">Minimal Theme</label>
            </div>
            <hr />
            <h6 class="mb-0">Header Colors</h6>
            <hr />
            <div class="header-colors-indigators">
                <div class="row row-cols-auto g-3">
                    <div class="col">
                        <div class="indigator headercolor1" id="headercolor1"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor2" id="headercolor2"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor3" id="headercolor3"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor4" id="headercolor4"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor5" id="headercolor5"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor6" id="headercolor6"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor7" id="headercolor7"></div>
                    </div>
                    <div class="col">
                        <div class="indigator headercolor8" id="headercolor8"></div>
                    </div>
                </div>
            </div>
            <hr />
            <h6 class="mb-0">Sidebar Colors</h6>
            <hr />
            <div class="header-colors-indigators">
                <div class="row row-cols-auto g-3">
                    <div class="col">
                        <div class="indigator sidebarcolor1" id="sidebarcolor1"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor2" id="sidebarcolor2"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor3" id="sidebarcolor3"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor4" id="sidebarcolor4"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor5" id="sidebarcolor5"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor6" id="sidebarcolor6"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor7" id="sidebarcolor7"></div>
                    </div>
                    <div class="col">
                        <div class="indigator sidebarcolor8" id="sidebarcolor8"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--end switcher-->

    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-storage.js"></script>

    <script>

const firebaseConfig = {
            apiKey: "AIzaSyCltKvwmPvnyKEnnD4EZFThl0DHsOOg5xU",
            authDomain: "cloudimage-6e701.firebaseapp.com",
            databaseURL: "https://cloudimage-6e701-default-rtdb.firebaseio.com",
            projectId: "cloudimage-6e701",
            storageBucket: "cloudimage-6e701.appspot.com",
            messagingSenderId: "478411923908",
            appId: "1:478411923908:web:6dcf035a33addaad914491",
            measurementId: "G-FYWZB855E1"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        console.log(firebase);
        function uploadImage() {

            const ref = firebase.storage().ref();
            const file = document.querySelector("#imageUrl").files[0];
            const name = +new Date() + "-" + file.name;
            const metadata = {
                contentType: file.type
            };
            const task = ref.child(name).put(file, metadata);
            task
                .then(snapshot => snapshot.ref.getDownloadURL())
                .then(url => {
                    console.log(url); 
                    document.getElementById("hidden").value = url;
                })
                return task;
        }

        const frmm = document.querySelector('#form');
                    frmm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const data = await fetch(window.location.origin + `/subCategory/<%=singleSubCat.id%>`, {
                            method: 'put',
                            body: JSON.stringify({

                                name: frmm.name.value,
                                name_ur: frmm.name_ur.value,
                                imageUrl: frmm.hidden.value,
                                status: frmm.status.value,
                            }),
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            }
                        })
                        const rec = await data.text();

                        console.log(rec)
                        if (rec) {

                            Swal.fire({

                                icon: 'success',
                                title: 'Sub Category Has been Updated',
                                showConfirmButton: false,
                                timer: 1500
                            })
                            document.querySelector('form').reset()

                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong!',

                            })
                        }
                    })
    </script>

    <%- include('../partials/adminFooter')%>